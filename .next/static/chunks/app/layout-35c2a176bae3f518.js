(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{254:function(e,t,r){Promise.resolve().then(r.t.bind(r,7960,23)),Promise.resolve().then(r.bind(r,4991)),Promise.resolve().then(r.bind(r,9660))},4991:function(e,t,r){"use strict";r.d(t,{ProfileProvider:function(){return u},U:function(){return s}});var n=r(7437),l=r(2265),i=r(2141);let a=(0,l.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,l.useState)(null),[s,o]=(0,l.useState)(!0),[c,d]=(0,l.useState)(null),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{user:t}}=await i.OQ.auth.getUser();if(!e)return;if(t){d(t.id);let{data:r,error:n}=await i.OQ.from("profiles").select("*").eq("id",t.id).single();if(!e)return;n?(console.error("Error loading profile:",n),u(null)):r&&u(r),f.current&&f.current.unsubscribe(),f.current=i.OQ.channel("profile_".concat(t.id,"_").concat(Date.now())).on("postgres_changes",{event:"*",schema:"public",table:"profiles",filter:"id=eq.".concat(t.id)},r=>{var n;e&&(null===(n=r.new)||void 0===n?void 0:n.id)===t.id&&u(r.new)}).subscribe(e=>{"SUBSCRIBED"===e&&console.log("Profile subscription active for user:",t.id)})}else u(null),d(null)}catch(t){console.error("Error initializing profile:",t),e&&u(null)}finally{e&&o(!1)}})();let{data:{subscription:t}}=i.OQ.auth.onAuthStateChange(async(t,n)=>{if(e){if("SIGNED_IN"===t&&(null==n?void 0:n.user)){d(n.user.id),r||o(!0);let{data:t,error:l}=await i.OQ.from("profiles").select("*").eq("id",n.user.id).single();e&&(t&&u(t),o(!1))}else"SIGNED_OUT"===t&&(u(null),d(null),f.current&&f.current.unsubscribe())}});return()=>{e=!1,null==t||t.unsubscribe(),f.current&&f.current.unsubscribe()}},[]);let m=async()=>{if(c)try{let{data:e}=await i.OQ.from("profiles").select("*").eq("id",c).single();e&&u(e)}catch(e){console.error("Error refreshing profile:",e)}finally{o(!1)}};return(0,n.jsx)(a.Provider,{value:{profile:r,loading:s,updateProfile:e=>{e.id===c&&(u(e),i.OQ.from("profiles").update({avatar_url:e.avatar_url,background_url:e.background_url}).eq("id",c).then(e=>{let{error:t}=e;t&&console.error("Error updating profile:",t)}))},refreshProfile:m},children:t})}function s(){let e=(0,l.useContext)(a);if(!e)throw Error("useProfile must be used within ProfileProvider");return e}},2141:function(e,t,r){"use strict";r.d(t,{OQ:function(){return n}});let n=(0,r(1545).eI)("https://mevfhlhwrrkbhppgeyaj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmZobGh3cnJrYmhwcGdleWFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NDgyMDIsImV4cCI6MjA3NzUyNDIwMn0.E_Rhnhh8dbRiBLTg52HpDfJSqv2Q_hE-mSjHlkLF2IE")},9660:function(e,t,r){"use strict";r.d(t,{F:function(){return s},ThemeProvider:function(){return o}});var n=r(7437),l=r(2265),i=r(2141);let a={"Facultad de Ciencias Empresariales":{primary:"#0066FF",secondary:"#E6F0FF",dark:"#0052CC",light:"#F0F7FF"},"Facultad de Derecho":{primary:"#FF0000",secondary:"#FFE6E6",dark:"#CC0000",light:"#FFF0F0"},"Facultad de Econom\xeda y Finanzas":{primary:"#00CC00",secondary:"#E6FFE6",dark:"#009900",light:"#F0FFF0"},"Facultad de Ingenier\xeda":{primary:"#FFCC00",secondary:"#FFFAE6",dark:"#CC9900",light:"#FFFBF0"}},u=(0,l.createContext)({faculty:null,colors:null,setFaculty:()=>{},loading:!0,themeMode:"glass",setThemeMode:()=>{}}),s=()=>(0,l.useContext)(u);function o(e){let{children:t}=e,[r,s]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[d,f]=(0,l.useState)("glass");(0,l.useEffect)(()=>{let e=localStorage.getItem("themeMode");e&&["light","dark","glass"].includes(e)?(f(e),document.documentElement.setAttribute("data-theme",e)):(f("glass"),document.documentElement.setAttribute("data-theme","glass"))},[]),(0,l.useEffect)(()=>{let e=async()=>{try{let{data:{user:e}}=await i.OQ.auth.getUser();if(e){let{data:t}=await i.OQ.from("profiles").select("carrera").eq("id",e.id).single();(null==t?void 0:t.carrera)?s(t.carrera):s(null)}else s(null)}catch(e){console.error("Error loading user faculty:",e),s(null)}finally{c(!1)}};e();let{data:{subscription:t}}=i.OQ.auth.onAuthStateChange(async(t,n)=>{("SIGNED_IN"===t||"SIGNED_OUT"===t||"USER_UPDATED"===t)&&(r||c(!0),await e())});return()=>{null==t||t.unsubscribe()}},[]),(0,l.useEffect)(()=>{if(r&&r in a){let e=a[r];document.documentElement.style.setProperty("--faculty-primary",e.primary),document.documentElement.style.setProperty("--faculty-secondary",e.secondary),document.documentElement.style.setProperty("--faculty-dark",e.dark),document.documentElement.style.setProperty("--faculty-light",e.light)}},[r]);let m=r&&r in a?a[r]:a["Facultad de Ciencias Empresariales"];return(0,n.jsx)(u.Provider,{value:{faculty:r,colors:m,setFaculty:e=>{s(e)},loading:o,themeMode:d,setThemeMode:e=>{f(e),localStorage.setItem("themeMode",e),document.documentElement.setAttribute("data-theme",e)}},children:t})}},7960:function(){}},function(e){e.O(0,[587,545,971,117,744],function(){return e(e.s=254)}),_N_E=e.O()}]);