(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2],{1656:function(e,r,t){Promise.resolve().then(t.bind(t,6757))},6757:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return m}});var a=t(7437),l=t(2265),n=t(9179),s=t(2141),o=t(8728),i=t(2369),c=t(4766),d=t(6337);let u=(0,t(9763).Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);var b=t(3581),h=t(3229),x=t(7692);function m(){var e;let{profile:r,refreshProfile:t}=(0,n.a)(),[m,f]=(0,l.useState)(!1),[p,v]=(0,l.useState)({nombre:(null==r?void 0:r.nombre)||"",carrera:(null==r?void 0:r.carrera)||"",universidad:(null==r?void 0:r.universidad)||"",bio:(null==r?void 0:r.bio)||""}),g=async()=>{if(null==r?void 0:r.id){f(!0);try{let{error:e}=await s.OQ.from("profiles").update(p).eq("id",r.id);if(e)throw e;await t(),alert("Perfil actualizado con \xe9xito")}catch(e){console.error("Error actualizando perfil:",e),alert("Ocurri\xf3 un error al actualizar")}finally{f(!1)}}};return(0,a.jsx)("div",{className:"min-h-screen bg-bb-dark p-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-10",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-600/20 rounded-2xl",children:(0,a.jsx)(o.Z,{className:"w-8 h-8 text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-black text-bb-text tracking-tight",children:"Configuraci\xf3n"}),(0,a.jsx)("p",{className:"text-bb-text-secondary",children:"Gestiona tu perfil y preferencias de cuenta"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"space-y-2",children:[{label:"Perfil P\xfablico",icon:i.Z,active:!0},{label:"Notificaciones",icon:c.Z},{label:"Seguridad",icon:d.Z},{label:"Dispositivos",icon:u}].map((e,r)=>(0,a.jsxs)("button",{className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold transition-all ".concat(e.active?"bg-blue-600 text-white shadow-lg shadow-blue-600/20":"text-bb-text-secondary hover:bg-white/5 hover:text-bb-text"),children:[(0,a.jsx)(e.icon,{className:"w-5 h-5"}),e.label]},r))}),(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-bb-card border border-bb-border rounded-3xl p-8 shadow-xl",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-bb-text mb-6",children:"Informaci\xf3n del Perfil"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6 mb-8 p-4 bg-white/5 rounded-2xl",children:[(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-2xl bg-blue-600 flex items-center justify-center text-3xl font-bold text-white overflow-hidden border-4 border-bb-card shadow-lg",children:(null==r?void 0:r.avatar_url)?(0,a.jsx)("img",{src:r.avatar_url,className:"w-full h-full object-cover",alt:"Profile"}):null==r?void 0:null===(e=r.nombre)||void 0===e?void 0:e.charAt(0)}),(0,a.jsx)("button",{className:"absolute -bottom-2 -right-2 p-2 bg-blue-500 rounded-lg text-white shadow-lg hover:scale-110 transition-transform",children:(0,a.jsx)(b.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-bb-text text-lg",children:null==r?void 0:r.nombre}),(0,a.jsx)("p",{className:"text-bb-text-secondary text-sm",children:null==r?void 0:r.carrera})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-bb-text-secondary uppercase tracking-widest mb-2",children:"Nombre Completo"}),(0,a.jsx)("input",{type:"text",value:p.nombre,onChange:e=>v({...p,nombre:e.target.value}),className:"w-full px-4 py-3 rounded-xl bg-bb-darker border border-bb-border text-bb-text focus:border-blue-500/50 transition-all outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-bb-text-secondary uppercase tracking-widest mb-2",children:"Carrera"}),(0,a.jsx)("input",{type:"text",value:p.carrera,onChange:e=>v({...p,carrera:e.target.value}),className:"w-full px-4 py-3 rounded-xl bg-bb-darker border border-bb-border text-bb-text focus:border-blue-500/50 transition-all outline-none"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-bb-text-secondary uppercase tracking-widest mb-2",children:"Universidad"}),(0,a.jsx)("input",{type:"text",value:p.universidad,onChange:e=>v({...p,universidad:e.target.value}),className:"w-full px-4 py-3 rounded-xl bg-bb-darker border border-bb-border text-bb-text focus:border-blue-500/50 transition-all outline-none"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold text-bb-text-secondary uppercase tracking-widest mb-2",children:"Biograf\xeda"}),(0,a.jsx)("textarea",{rows:4,value:p.bio,onChange:e=>v({...p,bio:e.target.value}),placeholder:"Cu\xe9ntanos algo sobre ti...",className:"w-full px-4 py-3 rounded-xl bg-bb-darker border border-bb-border text-bb-text focus:border-blue-500/50 transition-all outline-none resize-none"})]}),(0,a.jsx)("div",{className:"pt-6 border-t border-bb-border flex justify-end",children:(0,a.jsxs)("button",{onClick:g,disabled:m,className:"flex items-center gap-2 px-8 py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-xl shadow-lg shadow-blue-600/20 transition-all disabled:opacity-50",children:[m?(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white animate-spin rounded-full"}):(0,a.jsx)(h.Z,{className:"w-5 h-5"}),"Guardar Cambios"]})})]})]}),(0,a.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-3xl p-8",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-red-500 mb-2",children:"Zona de Peligro"}),(0,a.jsx)("p",{className:"text-bb-text-secondary text-sm mb-6",children:"Ten cuidado, estas acciones son irreversibles."}),(0,a.jsxs)("button",{className:"flex items-center gap-2 px-6 py-3 bg-red-500/20 hover:bg-red-500/30 text-red-500 font-bold rounded-xl border border-red-500/30 transition-all",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5"}),"Cerrar Sesi\xf3n en otros dispositivos"]})]})]})]})]})})}},9179:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return i},a:function(){return c}});var a=t(7437),l=t(2265),n=t(2141),s=t(9376);let o=(0,l.createContext)(void 0);function i(e){let{children:r}=e,[t,i]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),[u,b]=(0,l.useState)(null),[h,x]=(0,l.useState)(!0),m=(0,s.useRouter)();(0,l.useEffect)(()=>{let e=!0,{data:{subscription:r}}=n.OQ.auth.onAuthStateChange(async(r,t)=>{if(e){if(console.log("[Auth] Event: ".concat(r)),"SIGNED_OUT"===r){console.log("[Auth] Logout detectado. Limpiando estado..."),d(null),i(null),b(null),x(!1);return}(null==t?void 0:t.user)?(console.log("[Auth] Usuario autenticado: ".concat(t.user.email)),d(t),i(t.user),x(!1),("SIGNED_IN"===r||"INITIAL_SESSION"===r)&&f(t.user.id,t.user)):(d(null),i(null),b(null),x(!1))}});return()=>{e=!1,r.unsubscribe()}},[]);let f=async(e,r)=>{try{console.log("[Auth] Cargando perfil en background...");let{data:t,error:a}=await n.OQ.from("profiles").select("*").eq("id",e).single();if(a){console.error("[Auth] Error al cargar perfil:",a.message),"PGRST116"===a.code&&(console.log("[Auth] Perfil no existe. Creando..."),await p(e,r));return}t&&(console.log("[Auth] ✅ Perfil cargado:",t.nombre),b(t))}catch(e){console.error("[Auth] Error inesperado:",e)}},p=async(e,r)=>{try{var t;let a=r.user_metadata,l={id:e,nombre:(null==a?void 0:a.nombre)||(null===(t=r.email)||void 0===t?void 0:t.split("@")[0])||"Usuario",universidad:(null==a?void 0:a.universidad)||"Universidad Privada",carrera:(null==a?void 0:a.carrera)||"Estudiante",puntos:0},{data:s,error:o}=await n.OQ.from("profiles").insert([l]).select().single();if(o){console.error("[Auth] Error creando perfil:",o);return}console.log("[Auth] ✅ Perfil creado:",s.nombre),b(s)}catch(e){console.error("[Auth] Error al crear perfil:",e)}},v=async()=>{t&&await f(t.id,t)},g=async e=>{b(e)},y=async()=>{try{console.log("[Auth] Cerrando sesi\xf3n..."),await n.OQ.auth.signOut(),localStorage.clear(),sessionStorage.clear(),m.push("/auth/login")}catch(e){console.error("[Auth] Error en signOut:",e)}};return(0,a.jsx)(o.Provider,{value:{user:t,session:c,profile:u,loading:h,signOut:y,refreshProfile:v,updateProfile:g},children:r})}function c(){let e=(0,l.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2141:function(e,r,t){"use strict";t.d(r,{OQ:function(){return a},q4:function(){return l}});let a=(0,t(338).createBrowserClient)("https://mevfhlhwrrkbhppgeyaj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmZobGh3cnJrYmhwcGdleWFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NDgyMDIsImV4cCI6MjA3NzUyNDIwMn0.E_Rhnhh8dbRiBLTg52HpDfJSqv2Q_hE-mSjHlkLF2IE");async function l(e){return await e()}},9763:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(2265),l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=(e,r)=>{let t=(0,a.forwardRef)((t,s)=>{let{color:o="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:d,children:u,...b}=t;return(0,a.createElement)("svg",{ref:s,...l,width:i,height:i,stroke:o,strokeWidth:d?24*Number(c)/Number(i):c,className:"lucide lucide-".concat(n(e)),...b},[...r.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...(Array.isArray(u)?u:[u])||[]])});return t.displayName="".concat(e),t}},4766:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},3581:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},6337:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},7692:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},3229:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},8728:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2369:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},9376:function(e,r,t){"use strict";var a=t(5475);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[338,971,117,744],function(){return e(e.s=1656)}),_N_E=e.O()}]);