(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{2536:function(e,t,r){Promise.resolve().then(r.bind(r,8080))},8080:function(e,t,r){"use strict";r.d(t,{default:function(){return p}});var a=r(7437),l=r(2265),s=r(2141),n=r(9660),i=r(2660),o=r(8728),d=r(2718),c=r(5805),u=r(7760),m=r(8930),b=r(7648),x=r(6831),h=r(9376);function p(e){let{grupo:t,initialMiembros:r,initialIsMember:p,isAdmin:g,profile:f}=e,y=(0,h.useRouter)(),{colors:v}=(0,n.F)(),[j,N]=(0,l.useState)(r),[w,k]=(0,l.useState)(p),[_,F]=(0,l.useState)(!1),[E,C]=(0,l.useState)({link_whatsapp:t.link_whatsapp||""}),[I,S]=(0,l.useState)(null),[A,U]=(0,l.useState)({x:0,y:0});(0,l.useEffect)(()=>{N(r),k(p),C({link_whatsapp:t.link_whatsapp||""})},[r,p,t]);let D=(e,t)=>{let r=e.currentTarget.getBoundingClientRect(),a=window.innerWidth,l=r.right+10,s=r.top;l+320>a&&(l=r.left-320-10),s+280>window.innerHeight&&(s=window.innerHeight-280-20),S(t),U({x:l,y:s})},O=async()=>{try{let{error:e}=await s.OQ.from("grupo_miembros").insert([{grupo_id:t.id,user_id:null==f?void 0:f.id}]);if(e)throw e;y.refresh()}catch(e){console.error("Error uni\xe9ndose:",e)}},q=async()=>{try{let{error:e}=await s.OQ.from("grupo_miembros").delete().eq("grupo_id",t.id).eq("user_id",null==f?void 0:f.id);if(e)throw e;y.refresh()}catch(e){console.error("Error abandonando:",e)}},Q=async()=>{try{let{error:e}=await s.OQ.from("grupos").update({link_whatsapp:E.link_whatsapp}).eq("id",t.id);if(e)throw e;F(!1),y.refresh()}catch(e){console.error("Error actualizando:",e)}},z=async()=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas eliminar este grupo?"))try{let{error:e}=await s.OQ.from("grupos").delete().eq("id",t.id);if(e)throw e;y.push("/dashboard/grupos")}catch(e){console.error("Error eliminando:",e)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-bb-dark",children:[(0,a.jsxs)("div",{className:"relative h-64 bg-gradient-to-r",style:{backgroundImage:t.banner_url?"url(".concat(t.banner_url,")"):void 0,backgroundSize:"cover",backgroundPosition:"center",backgroundColor:(null==v?void 0:v.primary)+"40"},children:[(0,a.jsx)(b.default,{href:"/dashboard/grupos",className:"absolute top-6 left-6 p-2 rounded-lg bg-black bg-opacity-50 hover:bg-opacity-70 transition-all",children:(0,a.jsx)(i.Z,{className:"w-6 h-6 text-white"})}),g&&(0,a.jsx)("button",{onClick:()=>F(!0),className:"absolute top-6 right-6 p-2 rounded-lg bg-black bg-opacity-50 hover:bg-opacity-70 transition-all",children:(0,a.jsx)(o.Z,{className:"w-6 h-6 text-white"})})]}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 pb-12",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-8 -mt-20 relative z-10 mb-12",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex gap-6 items-start",children:[(0,a.jsx)("div",{className:"w-32 h-32 rounded-xl flex items-center justify-center text-white font-bold flex-shrink-0 border-4 border-bb-dark shadow-xl",style:{backgroundImage:t.logo_url?"url(".concat(t.logo_url,")"):void 0,backgroundSize:"cover",backgroundColor:null==v?void 0:v.primary},children:!t.logo_url&&t.nombre.charAt(0).toUpperCase()}),(0,a.jsxs)("div",{className:"flex-1 pt-4",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-white mb-2 shadow-sm",children:t.nombre}),(0,a.jsx)("p",{className:"text-lg text-gray-200 mb-4 font-medium",children:t.tipo}),t.descripcion&&(0,a.jsx)("p",{className:"text-gray-100 text-base leading-relaxed line-clamp-3 font-medium",children:t.descripcion})]})]})}),(0,a.jsx)("div",{className:"flex flex-col gap-3",children:w?(0,a.jsxs)(a.Fragment,{children:[t.link_whatsapp&&(0,a.jsxs)("a",{href:t.link_whatsapp,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-green-500 hover:bg-green-600 text-white font-semibold transition-all w-full md:w-auto",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Ir a WhatsApp"})]}),(0,a.jsx)("button",{onClick:q,className:"px-6 py-3 rounded-lg bg-red-500 bg-opacity-20 hover:bg-opacity-30 text-red-400 font-semibold transition-all",children:"Abandonar Grupo"})]}):(0,a.jsx)("button",{onClick:O,className:"px-6 py-3 rounded-lg text-white font-semibold transition-all",style:{backgroundColor:null==v?void 0:v.primary},children:"Unirse al Grupo"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-1 order-2 lg:order-2",children:(0,a.jsxs)("div",{className:"bg-bb-card rounded-xl p-6 border border-bb-border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5",style:{color:null==v?void 0:v.primary}}),(0,a.jsxs)("h2",{className:"text-xl font-bold text-bb-text",children:["Miembros (",j.length,")"]})]}),(0,a.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:j.map(e=>{var r,l;let s=t.created_by===e.user_id,n=e.profile;return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-bb-hover transition-all cursor-pointer",onMouseEnter:t=>D(t,e.user_id),onMouseLeave:()=>S(null),children:(0,a.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,a.jsxs)(x.qE,{className:"w-10 h-10 flex-shrink-0",children:[(0,a.jsx)(x.F$,{src:(null==n?void 0:n.avatar_url)||"",alt:(null==n?void 0:n.nombre)||"Usuario"}),(0,a.jsx)(x.Q5,{style:{backgroundColor:null==v?void 0:v.primary},children:(null==n?void 0:null===(r=n.nombre)||void 0===r?void 0:r.charAt(0).toUpperCase())||"U"})]}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-bb-text truncate",children:(null==n?void 0:n.nombre)||"Usuario"}),s&&(0,a.jsx)("span",{className:"text-xs text-blue-400 font-semibold",children:"Admin"})]})]})}),I===e.user_id&&(0,a.jsxs)("div",{className:"fixed bg-bb-card border border-bb-border rounded-xl shadow-2xl z-50 w-64 overflow-hidden animate-in fade-in zoom-in-95 duration-200",style:{left:"".concat(A.x+20,"px"),top:"".concat(A.y,"px")},children:[(0,a.jsx)("div",{className:"h-20 bg-cover bg-center relative",style:{backgroundImage:(null==n?void 0:n.background_url)?"url('".concat(n.background_url,"')"):"linear-gradient(135deg, ".concat(null==v?void 0:v.primary,"40, ").concat(null==v?void 0:v.secondary,"40)"),backgroundColor:(null==v?void 0:v.primary)+"20"},children:(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-bb-card/80 to-transparent"})}),(0,a.jsxs)("div",{className:"px-4 pb-4 relative",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center -mt-10",children:[(0,a.jsxs)(x.qE,{className:"w-20 h-20 ring-4 ring-bb-card shadow-lg",children:[(0,a.jsx)(x.F$,{src:(null==n?void 0:n.avatar_url)||"",alt:(null==n?void 0:n.nombre)||"Usuario"}),(0,a.jsx)(x.Q5,{style:{backgroundColor:null==v?void 0:v.primary},children:(null==n?void 0:null===(l=n.nombre)||void 0===l?void 0:l.charAt(0).toUpperCase())||"U"})]}),(0,a.jsxs)("div",{className:"text-center mt-2 w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-bb-text truncate leading-tight",children:(null==n?void 0:n.nombre)||"Usuario"}),(null==n?void 0:n.link_instagram)&&(0,a.jsx)("a",{href:n.link_instagram.startsWith("http")?n.link_instagram:"https://instagram.com/".concat(n.link_instagram),target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 hover:scale-110 transition-transform",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(u.Z,{className:"w-4 h-4 text-pink-500"})})]}),(null==n?void 0:n.carrera)&&(0,a.jsx)("p",{className:"text-xs text-bb-text-secondary mt-0.5 truncate",children:n.carrera}),s&&(0,a.jsx)("span",{className:"inline-block mt-1 px-2 py-0.5 rounded-full text-[10px] font-bold bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"Administrador"})]})]}),(null==n?void 0:n.bio)&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-bb-border",children:(0,a.jsxs)("p",{className:"text-xs text-bb-text-secondary italic line-clamp-2 text-center",children:['"',n.bio,'"']})}),(0,a.jsxs)("div",{className:"mt-3 flex justify-between items-center text-[10px] text-bb-text-secondary opacity-70",children:[(0,a.jsx)("span",{children:"Se uni\xf3"}),(0,a.jsx)("span",{children:new Date(e.joined_at).toLocaleDateString("es-ES",{month:"short",year:"numeric"})})]})]})]})]},e.user_id)})})]})}),(0,a.jsx)("div",{className:"lg:col-span-2 order-1 lg:order-1",children:(0,a.jsxs)("div",{className:"bg-bb-card rounded-xl p-6 border border-bb-border",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-bb-text mb-4",children:"Detalles del Grupo"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-bb-text-secondary mb-2",children:"Tipo de Grupo"}),(0,a.jsx)("p",{className:"text-lg text-bb-text font-semibold",children:t.tipo})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-bb-text-secondary mb-2",children:"Creado el"}),(0,a.jsx)("p",{className:"text-bb-text",children:new Date(t.created_at).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})})]}),t.link_whatsapp&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-bb-text-secondary mb-2",children:"Grupo de WhatsApp"}),(0,a.jsx)("a",{href:t.link_whatsapp,target:"_blank",rel:"noopener noreferrer",className:"text-green-400 hover:text-green-300 break-all",children:t.link_whatsapp})]}),g&&(0,a.jsxs)("div",{className:"pt-6 border-t border-bb-border",children:[(0,a.jsxs)("button",{onClick:()=>F(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-500 hover:bg-blue-600 text-white font-semibold transition-all mb-3",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),"Editar Link WhatsApp"]}),(0,a.jsxs)("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-red-500 hover:bg-red-600 text-white font-semibold transition-all",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),"Eliminar Grupo"]})]})]})]})})]})]}),_&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-bb-card rounded-xl w-full max-w-md border border-bb-border",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-bb-text mb-4",children:"Editar Link WhatsApp"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-bb-text mb-2",children:"Link de WhatsApp"}),(0,a.jsx)("input",{type:"url",value:E.link_whatsapp,onChange:e=>C({...E,link_whatsapp:e.target.value}),placeholder:"https://chat.whatsapp.com/...",className:"w-full px-4 py-2 rounded-lg bg-bb-darker border border-bb-border text-bb-text placeholder:text-bb-text-secondary focus:outline-none focus:border-gray-500"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>F(!1),className:"flex-1 px-4 py-2 rounded-lg border border-bb-border text-bb-text-secondary font-semibold hover:border-bb-border/80 transition-all",children:"Cancelar"}),(0,a.jsx)("button",{onClick:Q,className:"flex-1 px-4 py-2 rounded-lg text-white font-semibold transition-all",style:{backgroundColor:null==v?void 0:v.primary},children:"Guardar"})]})]})})})]})}},6831:function(e,t,r){"use strict";r.d(t,{F$:function(){return o},Q5:function(){return d},qE:function(){return i}});var a=r(7437),l=r(2265),s=r(1146),n=r(4508);let i=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.fC,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...l})});i.displayName=s.fC.displayName;let o=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.Ee,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",r),...l})});o.displayName=s.Ee.displayName;let d=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.NY,{ref:t,className:(0,n.cn)("flex items-center justify-center bg-gray-100 text-gray-900",r),...l})});d.displayName=s.NY.displayName},2141:function(e,t,r){"use strict";r.d(t,{OQ:function(){return a},q4:function(){return l}});let a=(0,r(338).createBrowserClient)("https://mevfhlhwrrkbhppgeyaj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmZobGh3cnJrYmhwcGdleWFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NDgyMDIsImV4cCI6MjA3NzUyNDIwMn0.E_Rhnhh8dbRiBLTg52HpDfJSqv2Q_hE-mSjHlkLF2IE");async function l(e){return await e()}},9660:function(e,t,r){"use strict";r.d(t,{F:function(){return o},ThemeProvider:function(){return d}});var a=r(7437),l=r(2265),s=r(2141);let n={"Facultad de Ciencias Empresariales":{primary:"#0066FF",secondary:"#E6F0FF",dark:"#0052CC",light:"#F0F7FF"},"Facultad de Derecho":{primary:"#FF0000",secondary:"#FFE6E6",dark:"#CC0000",light:"#FFF0F0"},"Facultad de Econom\xeda y Finanzas":{primary:"#00CC00",secondary:"#E6FFE6",dark:"#009900",light:"#F0FFF0"},"Facultad de Ingenier\xeda":{primary:"#FFCC00",secondary:"#FFFAE6",dark:"#CC9900",light:"#FFFBF0"}},i=(0,l.createContext)({faculty:null,colors:null,setFaculty:()=>{},loading:!0,themeMode:"glass",setThemeMode:()=>{}}),o=()=>(0,l.useContext)(i);function d(e){let{children:t}=e,[r,o]=(0,l.useState)(null),[d,c]=(0,l.useState)(!0),[u,m]=(0,l.useState)("glass");(0,l.useEffect)(()=>{let e=localStorage.getItem("themeMode");e&&["light","dark","glass"].includes(e)?(m(e),document.documentElement.setAttribute("data-theme",e)):(m("glass"),document.documentElement.setAttribute("data-theme","glass"))},[]),(0,l.useEffect)(()=>{let e=async()=>{try{let{data:{user:e}}=await s.OQ.auth.getUser();if(e){let{data:t}=await s.OQ.from("profiles").select("carrera").eq("id",e.id).single();(null==t?void 0:t.carrera)?o(t.carrera):o(null)}else o(null)}catch(e){console.error("Error loading user faculty:",e),o(null)}finally{c(!1)}};e();let{data:{subscription:t}}=s.OQ.auth.onAuthStateChange(async(t,a)=>{("SIGNED_IN"===t||"SIGNED_OUT"===t||"USER_UPDATED"===t)&&(r||c(!0),await e())});return()=>{null==t||t.unsubscribe()}},[]),(0,l.useEffect)(()=>{if(r&&r in n){let e=n[r];document.documentElement.style.setProperty("--faculty-primary",e.primary),document.documentElement.style.setProperty("--faculty-secondary",e.secondary),document.documentElement.style.setProperty("--faculty-dark",e.dark),document.documentElement.style.setProperty("--faculty-light",e.light)}},[r]);let b=r&&r in n?n[r]:n["Facultad de Ciencias Empresariales"];return(0,a.jsx)(i.Provider,{value:{faculty:r,colors:b,setFaculty:e=>{o(e)},loading:d,themeMode:u,setThemeMode:e=>{m(e),localStorage.setItem("themeMode",e),document.documentElement.setAttribute("data-theme",e)}},children:t})}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(1994),l=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,l.m6)((0,a.W)(t))}}},function(e){e.O(0,[338,137,451,990,971,117,744],function(){return e(e.s=2536)}),_N_E=e.O()}]);