(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[357],{7106:function(e,t,r){Promise.resolve().then(r.bind(r,3224))},3224:function(e,t,r){"use strict";r.d(t,{default:function(){return g}});var a=r(7437),l=r(2265),s=r(2141),n=r(9660),i=r(9397),o=r(3247),c=r(5805),d=r(8728),u=r(6858),m=r(2489),p=r(7648),b=r(8239),h=r(7586),x=r(9235),f=r(9376);function g(e){let{initialGrupos:t,userGruposIds:r,miembrosCounts:g,profile:y}=e,{colors:v}=(0,n.F)(),w=(0,f.useRouter)(),[j,N]=(0,l.useState)(t),[C,F]=(0,l.useState)(new Set(r)),[k,E]=(0,l.useState)(g),[_,S]=(0,l.useState)(""),[I,D]=(0,l.useState)(!1),[O,M]=(0,l.useState)(null),[Z,P]=(0,l.useState)({nombre:"",descripcion:"",tipo:"",link_whatsapp:""}),[Q,A]=(0,l.useState)(null),[U,G]=(0,l.useState)(null),[J,L]=(0,l.useState)(!1),[q,z]=(0,l.useState)(!1),T=()=>{let e=Date.now()+1e3,t=[(null==v?void 0:v.primary)||"#3b82f6","#ffffff"];!function r(){(0,x.Z)({particleCount:2,angle:60,spread:55,origin:{x:0},colors:t}),(0,x.Z)({particleCount:2,angle:120,spread:55,origin:{x:1},colors:t}),Date.now()<e&&requestAnimationFrame(r)}()},B=async(e,t)=>{if(e.preventDefault(),e.stopPropagation(),null==y?void 0:y.id)try{let{error:e}=await s.OQ.from("grupo_miembros").insert([{grupo_id:t,user_id:y.id}]);if(e)throw e;F(e=>new Set([...e,t])),E(e=>({...e,[t]:(e[t]||0)+1})),T()}catch(e){console.error(e)}},R=async(e,t)=>{if(e.preventDefault(),e.stopPropagation(),(null==y?void 0:y.id)&&confirm("\xbfEst\xe1s seguro?"))try{let{error:e}=await s.OQ.from("grupo_miembros").delete().eq("grupo_id",t).eq("user_id",y.id);if(e)throw e;F(e=>{let r=new Set(e);return r.delete(t),r}),E(e=>({...e,[t]:Math.max(0,(e[t]||0)-1)}))}catch(e){console.error(e)}},H=async e=>{if(!e||!(null==y?void 0:y.id))return null;let t=e.name.split(".").pop(),r="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2),".").concat(t),a="".concat(y.id,"/").concat(r);try{await s.OQ.storage.from("grupos").upload(a,e);let{data:t}=s.OQ.storage.from("grupos").getPublicUrl(a);return t.publicUrl}catch(e){return null}},X=async e=>{if(e.preventDefault(),Z.nombre&&Z.tipo)try{let e=null==O?void 0:O.logo_url,t=null==O?void 0:O.banner_url;Q&&(L(!0),e=await H(Q),L(!1)),U&&(z(!0),t=await H(U),z(!1));let r={...Z,logo_url:e,banner_url:t};O?await s.OQ.from("grupos").update(r).eq("id",O.id):(await s.OQ.from("grupos").insert([{...r,created_by:null==y?void 0:y.id}]),T()),D(!1),w.refresh()}catch(e){console.error(e)}},Y=j.filter(e=>e.nombre.toLowerCase().includes(_.toLowerCase())||e.tipo.toLowerCase().includes(_.toLowerCase()));return(0,a.jsxs)("div",{className:"min-h-screen bg-bb-dark p-8 relative overflow-hidden",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto relative z-10",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-12 gap-4",children:[(0,a.jsxs)(b.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:[(0,a.jsxs)("h1",{className:"text-5xl font-black text-bb-text mb-2 tracking-tight flex items-center gap-3",children:["Grupos ",(0,a.jsx)("span",{className:"text-blue-400",children:"Universitarios"})]}),(0,a.jsx)("p",{className:"text-bb-text-secondary text-lg max-w-xl",children:"Conecta con comunidades lideradas por estudiantes."})]}),(0,a.jsxs)(b.E.button,{whileHover:{scale:1.02},onClick:()=>{M(null),P({nombre:"",descripcion:"",tipo:"",link_whatsapp:""}),D(!0)},className:"flex items-center gap-2 px-8 py-4 rounded-xl font-bold text-white bg-blue-600 hover:bg-blue-500 transition-all",children:[(0,a.jsx)(i.Z,{className:"w-6 h-6"})," Crear Nuevo Grupo"]})]}),(0,a.jsxs)(b.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-10 relative max-w-2xl",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-4 flex items-center pointer-events-none",children:(0,a.jsx)(o.Z,{className:"w-5 h-5 text-bb-text-secondary"})}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar...",value:_,onChange:e=>S(e.target.value),className:"w-full pl-12 pr-4 py-4 rounded-xl bg-bb-card border border-bb-border text-bb-text focus:outline-none transition-all"})]}),0===Y.length?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)(c.Z,{className:"w-16 h-16 text-gray-500 mx-auto mb-6"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-white",children:"Sin grupos"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:(0,a.jsx)(h.M,{children:Y.map((e,t)=>{let r=C.has(e.id),l=e.created_by===(null==y?void 0:y.id);return(0,a.jsx)(b.E.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:(0,a.jsxs)(p.default,{href:"/dashboard/grupos/".concat(e.id),className:"group block h-full rounded-2xl overflow-hidden bg-bb-card border border-bb-border hover:border-blue-500/30 transition-all shadow-xl relative",children:[(0,a.jsxs)("div",{className:"h-40 relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:e.banner_url?"url(".concat(e.banner_url,")"):void 0,backgroundColor:"#1e293b"}}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-bb-card to-transparent"}),l&&(0,a.jsx)("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),M(e),P({nombre:e.nombre,descripcion:e.descripcion||"",tipo:e.tipo,link_whatsapp:e.link_whatsapp||""}),D(!0)},className:"absolute top-3 right-3 p-2 rounded-full bg-black/60 text-white opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(d.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"absolute bottom-4 left-4 px-3 py-1 rounded-full text-xs font-bold bg-black/60 text-white border border-white/10",children:e.tipo})]}),(0,a.jsxs)("div",{className:"p-6 pt-12 relative text-white",children:[(0,a.jsx)("div",{className:"absolute -top-10 left-6 w-20 h-20 rounded-2xl border-4 border-bb-card bg-blue-600 flex items-center justify-center text-2xl font-bold overflow-hidden",children:e.logo_url?(0,a.jsx)("img",{src:e.logo_url,className:"w-full h-full object-cover"}):e.nombre.charAt(0).toUpperCase()}),(0,a.jsx)("div",{className:"flex justify-between items-start mb-2 pl-24 text-xs text-gray-400",children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(c.Z,{className:"w-3.5 h-3.5"})," ",k[e.id]||0]})}),(0,a.jsx)("h3",{className:"text-xl font-bold mb-2 group-hover:text-blue-400 transition-colors truncate",children:e.nombre}),(0,a.jsx)("p",{className:"text-sm text-gray-400 line-clamp-2 mb-6 h-10",children:e.descripcion||"Sin descripci\xf3n."}),(0,a.jsx)("div",{className:"flex gap-3 mt-auto",children:r?(0,a.jsx)("button",{onClick:t=>R(t,e.id),className:"flex-1 px-4 py-2.5 rounded-xl bg-red-500/10 text-red-500 border border-red-500/20 text-sm font-semibold",children:"Abandonar"}):(0,a.jsxs)("button",{onClick:t=>B(t,e.id),className:"flex-1 px-4 py-2.5 rounded-xl bg-blue-600 text-white font-bold text-sm flex items-center justify-center gap-2",children:["Unirse ",(0,a.jsx)(u.Z,{className:"w-4 h-4"})]})})]})]})},e.id)})})})]}),(0,a.jsx)(h.M,{children:I&&(0,a.jsx)(b.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(b.E.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-[#242424] rounded-3xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-white/10 p-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8 border-b border-white/5 pb-6 text-white",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold",children:O?"Editar Grupo":"Crear Comunidad"}),(0,a.jsx)("button",{onClick:()=>D(!1),className:"text-gray-400",children:(0,a.jsx)(m.Z,{})})]}),(0,a.jsxs)("form",{onSubmit:X,className:"space-y-6 text-white",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsx)("input",{type:"text",placeholder:"Nombre",value:Z.nombre,onChange:e=>P({...Z,nombre:e.target.value}),className:"bg-black/40 border border-white/10 p-3 rounded-xl"}),(0,a.jsx)("input",{type:"text",placeholder:"Tipo",value:Z.tipo,onChange:e=>P({...Z,tipo:e.target.value}),className:"bg-black/40 border border-white/10 p-3 rounded-xl"})]}),(0,a.jsx)("textarea",{rows:4,placeholder:"Descripci\xf3n",value:Z.descripcion,onChange:e=>P({...Z,descripcion:e.target.value}),className:"w-full bg-black/40 border border-white/10 p-3 rounded-xl"}),(0,a.jsx)("input",{type:"url",placeholder:"WhatsApp Link",value:Z.link_whatsapp,onChange:e=>P({...Z,link_whatsapp:e.target.value}),className:"w-full bg-black/40 border border-white/10 p-3 rounded-xl"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"border-2 border-dashed border-white/10 p-4 rounded-xl text-center",children:(0,a.jsxs)("label",{className:"cursor-pointer",children:["Logo",(0,a.jsx)("input",{type:"file",className:"hidden",onChange:e=>{var t;return A((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}})]})}),(0,a.jsx)("div",{className:"border-2 border-dashed border-white/10 p-4 rounded-xl text-center",children:(0,a.jsxs)("label",{className:"cursor-pointer",children:["Banner",(0,a.jsx)("input",{type:"file",className:"hidden",onChange:e=>{var t;return G((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>D(!1),children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",className:"bg-blue-600 px-8 py-3 rounded-xl font-bold",children:"Guardar"})]})]})]})})})]})}},2141:function(e,t,r){"use strict";r.d(t,{OQ:function(){return a},q4:function(){return l}});let a=(0,r(338).createBrowserClient)("https://mevfhlhwrrkbhppgeyaj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmZobGh3cnJrYmhwcGdleWFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NDgyMDIsImV4cCI6MjA3NzUyNDIwMn0.E_Rhnhh8dbRiBLTg52HpDfJSqv2Q_hE-mSjHlkLF2IE");async function l(e){return await e()}},9660:function(e,t,r){"use strict";r.d(t,{F:function(){return o},ThemeProvider:function(){return c}});var a=r(7437),l=r(2265),s=r(2141);let n={"Facultad de Ciencias Empresariales":{primary:"#0066FF",secondary:"#E6F0FF",dark:"#0052CC",light:"#F0F7FF"},"Facultad de Derecho":{primary:"#FF0000",secondary:"#FFE6E6",dark:"#CC0000",light:"#FFF0F0"},"Facultad de Econom\xeda y Finanzas":{primary:"#00CC00",secondary:"#E6FFE6",dark:"#009900",light:"#F0FFF0"},"Facultad de Ingenier\xeda":{primary:"#FFCC00",secondary:"#FFFAE6",dark:"#CC9900",light:"#FFFBF0"}},i=(0,l.createContext)({faculty:null,colors:null,setFaculty:()=>{},loading:!0,themeMode:"glass",setThemeMode:()=>{}}),o=()=>(0,l.useContext)(i);function c(e){let{children:t}=e,[r,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(!0),[u,m]=(0,l.useState)("glass");(0,l.useEffect)(()=>{let e=localStorage.getItem("themeMode");e&&["light","dark","glass"].includes(e)?(m(e),document.documentElement.setAttribute("data-theme",e)):(m("glass"),document.documentElement.setAttribute("data-theme","glass"))},[]),(0,l.useEffect)(()=>{let e=async()=>{try{let{data:{user:e}}=await s.OQ.auth.getUser();if(e){let{data:t}=await s.OQ.from("profiles").select("carrera").eq("id",e.id).single();(null==t?void 0:t.carrera)?o(t.carrera):o(null)}else o(null)}catch(e){console.error("Error loading user faculty:",e),o(null)}finally{d(!1)}};e();let{data:{subscription:t}}=s.OQ.auth.onAuthStateChange(async(t,a)=>{("SIGNED_IN"===t||"SIGNED_OUT"===t||"USER_UPDATED"===t)&&(r||d(!0),await e())});return()=>{null==t||t.unsubscribe()}},[]),(0,l.useEffect)(()=>{if(r&&r in n){let e=n[r];document.documentElement.style.setProperty("--faculty-primary",e.primary),document.documentElement.style.setProperty("--faculty-secondary",e.secondary),document.documentElement.style.setProperty("--faculty-dark",e.dark),document.documentElement.style.setProperty("--faculty-light",e.light)}},[r]);let p=r&&r in n?n[r]:n["Facultad de Ciencias Empresariales"];return(0,a.jsx)(i.Provider,{value:{faculty:r,colors:p,setFaculty:e=>{o(e)},loading:c,themeMode:u,setThemeMode:e=>{m(e),localStorage.setItem("themeMode",e),document.documentElement.setAttribute("data-theme",e)}},children:t})}}},function(e){e.O(0,[338,451,239,372,971,117,744],function(){return e(e.s=7106)}),_N_E=e.O()}]);