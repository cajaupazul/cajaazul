(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[760],{8417:function(e,t,r){Promise.resolve().then(r.bind(r,683))},683:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return S}});var a=r(7437),n=r(2265),s=r(9660),o=r(9376),l=r(9179),i=r(9e3);function d(e){let{children:t}=e,r=(0,o.useRouter)(),{user:i,loading:d}=(0,l.a)(),{colors:u}=(0,s.F)();return((0,n.useEffect)(()=>{d||i||(console.log("[ProtectedRoute] No hay usuario. Redirigiendo a login..."),r.push("/auth/login"))},[i,d,r]),d)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-bb-dark",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-full border-4 border-t-transparent animate-spin",style:{borderColor:"".concat(null==u?void 0:u.primary," transparent transparent transparent")}}),(0,a.jsx)("div",{className:"w-16 h-16 rounded-full border-4 border-white/20 absolute inset-0"})]}),(0,a.jsx)("p",{className:"text-bb-text-secondary text-sm",children:"Verificando sesi\xf3n..."})]})}):i?(0,a.jsx)(a.Fragment,{children:t}):null}var u=r(5832),c=r(1769),f=r(5805),m=r(1047),h=r(9763);let x=(0,h.Z)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),b=(0,h.Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var y=r(3245),p=r(2489),v=r(8728),g=r(7692);let w=(0,h.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var N=r(4766),j=r(7648),k=r(6831),C=r(6110),E=r(2869);function S(e){var t,r,h,S,F,I,Z,_;let{children:A}=e;(0,o.useRouter)();let z=(0,o.usePathname)(),{colors:O}=(0,s.F)(),{profile:P,signOut:R,user:D}=(0,l.a)(),{refreshAll:M}=(0,i.r)(),[q,L]=(0,n.useState)(!0),U=(0,n.useRef)(!1),[V,Q]=(0,n.useState)(!1),[T,B]=(0,n.useState)(!1);(0,n.useEffect)(()=>{D&&P&&!U.current&&(console.log("[AuthenticatedLayout] Prefetching dashboard data..."),M(P.id),U.current=!0)},[D,P,M]);let H=async()=>{Q(!1),B(!0),await R()},G=e=>z===e,J=[{label:"Inicio",href:"/dashboard",icon:u.Z},{label:"Cursos",href:"/dashboard/courses",icon:c.Z},{label:"Profesores",href:"/dashboard/professors",icon:f.Z},{label:"Eventos",href:"/dashboard/events",icon:m.Z},{label:"Grupos",href:"/dashboard/grupos",icon:x},{label:"Comunidad",href:"/dashboard/community",icon:b},{label:"Nosotros",href:"/dashboard/about",icon:y.Z}];return(0,a.jsx)(d,{children:(0,a.jsxs)("div",{className:"relative flex h-screen bg-bb-dark transition-colors duration-300",children:[q&&(0,a.jsxs)("div",{className:"w-72 flex flex-col bg-bb-sidebar border-r border-bb-border text-bb-text overflow-hidden flex-shrink-0 transition-colors duration-300",style:{borderRightColor:(null==O?void 0:O.primary)+"40"},children:[(0,a.jsxs)("div",{className:"border-b px-6 py-6 flex items-center justify-between flex-shrink-0",style:{borderColor:(null==O?void 0:O.primary)+"40"},children:[(0,a.jsxs)(j.default,{href:"/dashboard",className:"flex items-center space-x-3 group",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white font-bold shadow-lg",style:{backgroundColor:null==O?void 0:O.primary},children:"CL"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xl font-bold text-bb-text",children:"CampusLink"}),(0,a.jsx)("span",{className:"text-xs text-bb-text-secondary block",children:"Premium"})]})]}),(0,a.jsx)("button",{onClick:()=>L(!1),className:"p-2 rounded-lg text-bb-text hover:bg-bb-hover",children:(0,a.jsx)(p.Z,{className:"h-5 w-5"})})]}),(0,a.jsx)(j.default,{href:"/profile",className:"mx-4 mt-4 mb-2 rounded-xl p-4 hover:bg-bb-hover border cursor-pointer transition-all",style:{backgroundColor:"transparent",borderColor:(null==O?void 0:O.primary)+"40"},children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)(k.qE,{className:"h-14 w-14 ring-2 flex-shrink-0",style:{boxShadow:"0 0 0 2px ".concat(null==O?void 0:O.primary,"40")},children:[(0,a.jsx)(k.F$,{src:(null==P?void 0:P.avatar_url)||"",alt:(null==P?void 0:P.nombre)||(null==D?void 0:null===(t=D.user_metadata)||void 0===t?void 0:t.nombre)||"Usuario"}),(0,a.jsx)(k.Q5,{style:{backgroundColor:null==O?void 0:O.primary,color:"white"},children:((null==P?void 0:P.nombre)||(null==D?void 0:null===(r=D.user_metadata)||void 0===r?void 0:r.nombre)||(null==D?void 0:D.email)||"U").charAt(0).toUpperCase()})]}),(0,a.jsxs)("div",{className:"text-left min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-bb-text truncate",children:(null==P?void 0:P.nombre)||(null==D?void 0:null===(h=D.user_metadata)||void 0===h?void 0:h.nombre)||(null==D?void 0:null===(S=D.email)||void 0===S?void 0:S.split("@")[0])||"Usuario"}),(0,a.jsx)("p",{className:"text-xs text-bb-text-secondary truncate",children:(null==P?void 0:P.carrera)||(null==D?void 0:null===(F=D.user_metadata)||void 0===F?void 0:F.carrera)||"Estudiante"})]})]})}),(0,a.jsx)("nav",{className:"flex-1 px-0 py-6 overflow-y-auto",children:J.map(e=>{let t=e.icon,r=G(e.href);return(0,a.jsxs)(j.default,{href:e.href,className:"block w-full group relative transition-all duration-200",style:{backgroundColor:r?(null==O?void 0:O.primary)+"20":"transparent",paddingLeft:"1.5rem",paddingRight:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem",display:"flex",alignItems:"center",gap:"0.75rem",color:r?null==O?void 0:O.primary:"var(--bb-text-secondary)",textDecoration:"none",fontSize:"0.875rem"},children:[(0,a.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{backgroundColor:null==O?void 0:O.primary}}),(0,a.jsx)(t,{style:{width:"1.25rem",height:"1.25rem",flexShrink:0}}),(0,a.jsx)("span",{style:{fontWeight:r?"600":"500"},children:e.label})]},e.href)})}),(0,a.jsxs)("div",{className:"border-t px-0 py-3 flex-shrink-0",style:{borderColor:(null==O?void 0:O.primary)+"40"},children:[(0,a.jsxs)(j.default,{href:"/settings",className:"flex items-center gap-3 px-6 py-3 text-bb-text-secondary hover:text-bb-text group relative transition-all duration-200",style:{textDecoration:"none",fontSize:"0.875rem"},children:[(0,a.jsx)(v.Z,{style:{width:"1.25rem",height:"1.25rem",flexShrink:0}}),(0,a.jsx)("span",{children:"Configuraci\xf3n"}),(0,a.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{backgroundColor:null==O?void 0:O.primary}})]}),(0,a.jsxs)("button",{onClick:()=>{Q(!0)},className:"w-full flex items-center gap-3 px-6 py-3 text-bb-text-secondary hover:text-red-400 group relative transition-all duration-200",style:{textDecoration:"none",fontSize:"0.875rem",background:"none",border:"none",cursor:"pointer"},children:[(0,a.jsx)(g.Z,{style:{width:"1.25rem",height:"1.25rem",flexShrink:0}}),(0,a.jsx)("span",{children:"Cerrar Sesi\xf3n"}),(0,a.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",style:{backgroundColor:"#ef4444"}})]})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden bg-bb-dark transition-colors duration-300",children:[(0,a.jsxs)("header",{className:"border-b shadow-lg bg-bb-card sticky top-0 z-30 flex-shrink-0 transition-colors duration-300",style:{borderBottomColor:(null==O?void 0:O.primary)+"40"},children:[(0,a.jsx)("div",{className:"h-1",style:{backgroundColor:null==O?void 0:O.primary}}),(0,a.jsxs)("div",{className:"flex items-center justify-between h-20 px-4 sm:px-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[!q&&(0,a.jsx)("button",{onClick:()=>L(!0),className:"p-2 rounded-lg transition-all",style:{color:null==O?void 0:O.primary,backgroundColor:(null==O?void 0:O.primary)+"20"},children:(0,a.jsx)(w,{className:"h-6 w-6"})}),(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-bb-text truncate transition-colors",children:(null===(I=J.find(e=>G(e.href)))||void 0===I?void 0:I.label)||"Dashboard"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 sm:space-x-6",children:[(0,a.jsxs)("button",{className:"relative p-2 text-bb-text-secondary hover:text-bb-text transition-colors",children:[(0,a.jsx)(N.Z,{className:"h-6 w-6"}),(0,a.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 rounded-full",style:{backgroundColor:null==O?void 0:O.primary}})]}),!q&&(0,a.jsxs)(k.qE,{className:"h-10 w-10 cursor-pointer ring-2 flex-shrink-0",style:{boxShadow:"0 0 0 2px ".concat(null==O?void 0:O.primary,"40")},children:[(0,a.jsx)(k.F$,{src:(null==P?void 0:P.avatar_url)||"",alt:(null==P?void 0:P.nombre)||(null==D?void 0:null===(Z=D.user_metadata)||void 0===Z?void 0:Z.nombre)||"Usuario"}),(0,a.jsx)(k.Q5,{style:{backgroundColor:null==O?void 0:O.primary,color:"white"},children:((null==P?void 0:P.nombre)||(null==D?void 0:null===(_=D.user_metadata)||void 0===_?void 0:_.nombre)||(null==D?void 0:D.email)||"U").charAt(0).toUpperCase()})]})]})]})]}),(0,a.jsx)("main",{className:"flex-1 overflow-auto bg-bb-dark w-full transition-colors duration-300",children:A})]}),(0,a.jsx)(C.Vq,{open:V,onOpenChange:Q,children:(0,a.jsxs)(C.cZ,{className:"bg-bb-card border-bb-border sm:max-w-md",children:[(0,a.jsxs)(C.fK,{children:[(0,a.jsxs)(C.$N,{className:"text-bb-text flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"w-5 h-5 text-red-500"}),"Confirmar Cierre de Sesi\xf3n"]}),(0,a.jsx)(C.Be,{className:"text-bb-text-secondary",children:"\xbfEst\xe1s seguro de que deseas cerrar tu sesi\xf3n actual?"})]}),(0,a.jsxs)(C.cN,{className:"gap-2 sm:gap-0 mt-4",children:[(0,a.jsx)(E.z,{variant:"outline",onClick:()=>Q(!1),className:"border-bb-border text-bb-text hover:bg-bb-hover",children:"Cancelar"}),(0,a.jsx)(E.z,{onClick:H,className:"bg-red-500 hover:bg-red-600 text-white border-0",children:"S\xed, Cerrar Sesi\xf3n"})]})]})}),T&&(0,a.jsxs)("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-full border-4 border-t-transparent animate-spin",style:{borderColor:"".concat(null==O?void 0:O.primary," transparent transparent transparent")}}),(0,a.jsx)("div",{className:"w-16 h-16 rounded-full border-4 border-white/20 absolute inset-0"})]}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Cerrando Sesi\xf3n..."}),(0,a.jsx)("p",{className:"text-gray-400",children:"\xa1Esperamos verte pronto!"})]})]})})}},6831:function(e,t,r){"use strict";r.d(t,{F$:function(){return i},Q5:function(){return d},qE:function(){return l}});var a=r(7437),n=r(2265),s=r(1146),o=r(4508);let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.fC,{ref:t,className:(0,o.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...n})});l.displayName=s.fC.displayName;let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.Ee,{ref:t,className:(0,o.cn)("aspect-square h-full w-full",r),...n})});i.displayName=s.Ee.displayName;let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.NY,{ref:t,className:(0,o.cn)("flex items-center justify-center bg-gray-100 text-gray-900",r),...n})});d.displayName=s.NY.displayName},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var a=r(7437),n=r(2265),s=r(6791),o=r(535),l=r(4508);let i=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-200 bg-white hover:bg-gray-50 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 hover:text-gray-900",link:"text-blue-600 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3 text-xs",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:o,asChild:d=!1,...u}=e,c=d?s.g7:"button";return(0,a.jsx)(c,{className:(0,l.cn)(i({variant:n,size:o,className:r})),ref:t,...u})});d.displayName="Button"},6110:function(e,t,r){"use strict";r.d(t,{$N:function(){return x},Be:function(){return b},Vq:function(){return i},cN:function(){return h},cZ:function(){return f},fK:function(){return m},hg:function(){return d}});var a=r(7437),n=r(2265),s=r(3240),o=r(2489),l=r(4508);let i=s.fC,d=s.xz,u=s.h_;s.x8;let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n})});c.displayName=s.aV.displayName;let f=n.forwardRef((e,t)=>{let{className:r,children:n,...i}=e;return(0,a.jsxs)(u,{children:[(0,a.jsx)(c,{}),(0,a.jsxs)(s.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...i,children:[n,(0,a.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=s.VY.displayName;let m=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};m.displayName="DialogHeader";let h=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};h.displayName="DialogFooter";let x=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",r),...n})});x.displayName=s.Dx.displayName;let b=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(s.dk,{ref:t,className:(0,l.cn)("text-sm text-gray-500",r),...n})});b.displayName=s.dk.displayName},9179:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return i},a:function(){return d}});var a=r(7437),n=r(2265),s=r(2141),o=r(9376);let l=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[c,f]=(0,n.useState)(null),[m,h]=(0,n.useState)(!0),x=(0,o.useRouter)();(0,n.useEffect)(()=>{let e=!0,{data:{subscription:t}}=s.OQ.auth.onAuthStateChange(async(t,r)=>{if(e){if(console.log("[Auth] Event: ".concat(t)),"SIGNED_OUT"===t){console.log("[Auth] Logout detectado. Limpiando estado..."),u(null),i(null),f(null),h(!1);return}(null==r?void 0:r.user)?(console.log("[Auth] Usuario autenticado: ".concat(r.user.email)),u(r),i(r.user),h(!1),("SIGNED_IN"===t||"INITIAL_SESSION"===t)&&b(r.user.id,r.user)):(u(null),i(null),f(null),h(!1))}});return()=>{e=!1,t.unsubscribe()}},[]);let b=async(e,t)=>{try{console.log("[Auth] Cargando perfil en background...");let{data:r,error:a}=await s.OQ.from("profiles").select("*").eq("id",e).single();if(a){console.error("[Auth] Error al cargar perfil:",a.message),"PGRST116"===a.code&&(console.log("[Auth] Perfil no existe. Creando..."),await y(e,t));return}r&&(console.log("[Auth] ✅ Perfil cargado:",r.nombre),f(r))}catch(e){console.error("[Auth] Error inesperado:",e)}},y=async(e,t)=>{try{var r;let a=t.user_metadata,n={id:e,nombre:(null==a?void 0:a.nombre)||(null===(r=t.email)||void 0===r?void 0:r.split("@")[0])||"Usuario",universidad:(null==a?void 0:a.universidad)||"Universidad Privada",carrera:(null==a?void 0:a.carrera)||"Estudiante",puntos:0},{data:o,error:l}=await s.OQ.from("profiles").insert([n]).select().single();if(l){console.error("[Auth] Error creando perfil:",l);return}console.log("[Auth] ✅ Perfil creado:",o.nombre),f(o)}catch(e){console.error("[Auth] Error al crear perfil:",e)}},p=async()=>{r&&await b(r.id,r)},v=async e=>{f(e)},g=async()=>{try{console.log("[Auth] Cerrando sesi\xf3n..."),await s.OQ.auth.signOut(),localStorage.clear(),sessionStorage.clear(),x.push("/auth/login")}catch(e){console.error("[Auth] Error en signOut:",e)}};return(0,a.jsx)(l.Provider,{value:{user:r,session:d,profile:c,loading:m,signOut:g,refreshProfile:p,updateProfile:v},children:t})}function d(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9e3:function(e,t,r){"use strict";r.d(t,{DashboardDataProvider:function(){return i},r:function(){return d}});var a=r(7437),n=r(2265),s=r(2141),o=r(9179);let l=(0,n.createContext)(void 0);function i(e){let{children:t}=e,{session:r}=(0,o.a)(),[i,d]=(0,n.useState)([]),[u,c]=(0,n.useState)([]),[f,m]=(0,n.useState)([]),[h,x]=(0,n.useState)(new Set),[b,y]=(0,n.useState)({}),p=(0,n.useRef)(!1),[v,g]=(0,n.useState)({courses:!1,professors:!1,grupos:!1});n.useEffect(()=>{r||(d([]),c([]),m([]),x(new Set),y({}),p.current=!1)},[r]);let w=(0,n.useCallback)(async()=>{if(r){g(e=>({...e,courses:!0}));try{let{data:e,error:t}=await (0,s.q4)(async()=>await s.OQ.from("courses").select("*").order("nombre",{ascending:!0}));!t&&e&&d(e)}finally{g(e=>({...e,courses:!1}))}}},[r]),N=(0,n.useCallback)(async()=>{if(r){g(e=>({...e,professors:!0}));try{let{data:e,error:t}=await (0,s.q4)(async()=>await s.OQ.from("professors").select("\n                      *,\n                      professor_ratings (puntuacion)\n                    ").order("nombre",{ascending:!0}));if(!t&&e){let t=e.map(e=>{let t=e.professor_ratings||[],r=t.length>0?t.reduce((e,t)=>e+(t.puntuacion||0),0)/t.length:0;return{...e,averageRating:Math.round(10*r)/10,ratingCount:t.length}});c(t)}}finally{g(e=>({...e,professors:!1}))}}},[r]),j=(0,n.useCallback)(async()=>{if(r){g(e=>({...e,grupos:!0}));try{let{data:e,error:t}=await (0,s.q4)(async()=>await s.OQ.from("grupos").select("\n                      *,\n                      grupo_miembros(count)\n                    ").order("created_at",{ascending:!1}));if(!t&&e){m(e);let t={};e.forEach(e=>{var r,a;t[e.id]=(null===(a=e.grupo_miembros)||void 0===a?void 0:null===(r=a[0])||void 0===r?void 0:r.count)||0}),y(t)}}finally{g(e=>({...e,grupos:!1}))}}},[r]),k=(0,n.useCallback)(async e=>{if(e&&r)try{let{data:t,error:r}=await s.OQ.from("grupo_miembros").select("grupo_id").eq("user_id",e);!r&&t&&x(new Set(t.map(e=>e.grupo_id)))}catch(e){console.error("Error fetching user groups:",e)}},[r]),C=(0,n.useCallback)(async e=>{r&&await Promise.all([w(),N(),j(),e||r.user.id?k(e||r.user.id):Promise.resolve()])},[r,w,N,j,k]),E=(0,n.useMemo)(()=>({courses:i,professors:u,grupos:f,userGrupos:h,miembrosCuenta:b,loading:v,fetchCourses:w,fetchProfessors:N,fetchGrupos:j,fetchUserGrupos:k,refreshAll:C}),[i,u,f,h,b,v,w,N,j,k,C]);return(0,a.jsx)(l.Provider,{value:E,children:t})}function d(){let e=(0,n.useContext)(l);if(!e)throw Error("useDashboardData must be used within DashboardDataProvider");return e}},2141:function(e,t,r){"use strict";r.d(t,{OQ:function(){return a},q4:function(){return n}});let a=(0,r(338).createBrowserClient)("https://mevfhlhwrrkbhppgeyaj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmZobGh3cnJrYmhwcGdleWFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NDgyMDIsImV4cCI6MjA3NzUyNDIwMn0.E_Rhnhh8dbRiBLTg52HpDfJSqv2Q_hE-mSjHlkLF2IE");async function n(e){return await e()}},9660:function(e,t,r){"use strict";r.d(t,{F:function(){return i},ThemeProvider:function(){return d}});var a=r(7437),n=r(2265),s=r(2141);let o={"Facultad de Ciencias Empresariales":{primary:"#0066FF",secondary:"#E6F0FF",dark:"#0052CC",light:"#F0F7FF"},"Facultad de Derecho":{primary:"#FF0000",secondary:"#FFE6E6",dark:"#CC0000",light:"#FFF0F0"},"Facultad de Econom\xeda y Finanzas":{primary:"#00CC00",secondary:"#E6FFE6",dark:"#009900",light:"#F0FFF0"},"Facultad de Ingenier\xeda":{primary:"#FFCC00",secondary:"#FFFAE6",dark:"#CC9900",light:"#FFFBF0"}},l=(0,n.createContext)({faculty:null,colors:null,setFaculty:()=>{},loading:!0,themeMode:"glass",setThemeMode:()=>{}}),i=()=>(0,n.useContext)(l);function d(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[d,u]=(0,n.useState)(!0),[c,f]=(0,n.useState)("glass");(0,n.useEffect)(()=>{let e=localStorage.getItem("themeMode");e&&["light","dark","glass"].includes(e)?(f(e),document.documentElement.setAttribute("data-theme",e)):(f("glass"),document.documentElement.setAttribute("data-theme","glass"))},[]),(0,n.useEffect)(()=>{let e=async()=>{try{let{data:{user:e}}=await s.OQ.auth.getUser();if(e){let{data:t}=await s.OQ.from("profiles").select("carrera").eq("id",e.id).single();(null==t?void 0:t.carrera)?i(t.carrera):i(null)}else i(null)}catch(e){console.error("Error loading user faculty:",e),i(null)}finally{u(!1)}};e();let{data:{subscription:t}}=s.OQ.auth.onAuthStateChange(async(t,a)=>{("SIGNED_IN"===t||"SIGNED_OUT"===t||"USER_UPDATED"===t)&&(r||u(!0),await e())});return()=>{null==t||t.unsubscribe()}},[]),(0,n.useEffect)(()=>{if(r&&r in o){let e=o[r];document.documentElement.style.setProperty("--faculty-primary",e.primary),document.documentElement.style.setProperty("--faculty-secondary",e.secondary),document.documentElement.style.setProperty("--faculty-dark",e.dark),document.documentElement.style.setProperty("--faculty-light",e.light)}},[r]);let m=r&&r in o?o[r]:o["Facultad de Ciencias Empresariales"];return(0,a.jsx)(l.Provider,{value:{faculty:r,colors:m,setFaculty:e=>{i(e)},loading:d,themeMode:c,setThemeMode:e=>{f(e),localStorage.setItem("themeMode",e),document.documentElement.setAttribute("data-theme",e)}},children:t})}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return s}});var a=r(1994),n=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},4766:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},1769:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]])},1047:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},5832:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},3245:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},7692:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},8728:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},4369:function(e,t,r){"use strict";var a=r(2265),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=a.useState,o=a.useEffect,l=a.useLayoutEffect,i=a.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),a=s({inst:{value:r,getSnapshot:t}}),n=a[0].inst,u=a[1];return l(function(){n.value=r,n.getSnapshot=t,d(n)&&u({inst:n})},[e,r,t]),o(function(){return d(n)&&u({inst:n}),e(function(){d(n)&&u({inst:n})})},[e]),i(r),r};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:u},2558:function(e,t,r){"use strict";e.exports=r(4369)},1146:function(e,t,r){"use strict";r.d(t,{NY:function(){return k},Ee:function(){return j},fC:function(){return N}});var a=r(2265),n=r(3966),s=r(6606),o=r(1188),l=r(2912),i=r(2558);function d(){return()=>{}}var u=r(7437),c="Avatar",[f,m]=(0,n.b)(c),[h,x]=f(c),b=a.forwardRef((e,t)=>{let{__scopeAvatar:r,...n}=e,[s,o]=a.useState("idle");return(0,u.jsx)(h,{scope:r,imageLoadingStatus:s,onImageLoadingStatusChange:o,children:(0,u.jsx)(l.WV.span,{...n,ref:t})})});b.displayName=c;var y="AvatarImage",p=a.forwardRef((e,t)=>{let{__scopeAvatar:r,src:n,onLoadingStatusChange:c=()=>{},...f}=e,m=x(y,r),h=function(e,t){let{referrerPolicy:r,crossOrigin:n}=t,s=(0,i.useSyncExternalStore)(d,()=>!0,()=>!1),l=a.useRef(null),u=s?(l.current||(l.current=new window.Image),l.current):null,[c,f]=a.useState(()=>w(u,e));return(0,o.b)(()=>{f(w(u,e))},[u,e]),(0,o.b)(()=>{let e=e=>()=>{f(e)};if(!u)return;let t=e("loaded"),a=e("error");return u.addEventListener("load",t),u.addEventListener("error",a),r&&(u.referrerPolicy=r),"string"==typeof n&&(u.crossOrigin=n),()=>{u.removeEventListener("load",t),u.removeEventListener("error",a)}},[u,n,r]),c}(n,f),b=(0,s.W)(e=>{c(e),m.onImageLoadingStatusChange(e)});return(0,o.b)(()=>{"idle"!==h&&b(h)},[h,b]),"loaded"===h?(0,u.jsx)(l.WV.img,{...f,ref:t,src:n}):null});p.displayName=y;var v="AvatarFallback",g=a.forwardRef((e,t)=>{let{__scopeAvatar:r,delayMs:n,...s}=e,o=x(v,r),[i,d]=a.useState(void 0===n);return a.useEffect(()=>{if(void 0!==n){let e=window.setTimeout(()=>d(!0),n);return()=>window.clearTimeout(e)}},[n]),i&&"loaded"!==o.imageLoadingStatus?(0,u.jsx)(l.WV.span,{...s,ref:t}):null});function w(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}g.displayName=v;var N=b,j=p,k=g}},function(e){e.O(0,[338,137,451,183,769,971,117,744],function(){return e(e.s=8417)}),_N_E=e.O()}]);