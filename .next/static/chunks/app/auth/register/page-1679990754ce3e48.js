(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{2864:function(e,t,r){Promise.resolve().then(r.bind(r,8176))},8176:function(e,t,r){"use strict";r.d(t,{default:function(){return x}});var a=r(7437),s=r(2265),l=r(9376),n=r(7648),i=r(2141),o=r(2869),d=r(5186),c=r(6815),u=r(3647),m=r(7769),f=r(2208),h=r(2775);let p=["Facultad de Ciencias Empresariales","Facultad de Derecho","Facultad de Econom\xeda y Finanzas","Facultad de Ingenier\xeda"];function x(e){let{initialImageUrl:t}=e,r=(0,l.useRouter)(),[x,b]=(0,s.useState)(!1),[g,y]=(0,s.useState)(""),[v,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)({nombre:"",email:"",password:"",universidad:"Universidad Nacional",carrera:""}),F=async e=>{if(e.preventDefault(),y(""),!j.nombre.trim()||!j.email.trim()||!j.password.trim()||!j.carrera){y("Por favor completa todos los campos");return}if(j.password.length<6){y("La contrase\xf1a debe tener al menos 6 caracteres");return}b(!0);try{let{data:e,error:t}=await i.OQ.auth.signUp({email:j.email.trim(),password:j.password,options:{data:{nombre:j.nombre.trim(),universidad:j.universidad,carrera:j.carrera}}});if(t){y(t.message||"Error al crear la cuenta"),b(!1);return}if(!e.user){y("Error al crear la cuenta"),b(!1);return}await new Promise(e=>setTimeout(e,800));let{error:a}=await i.OQ.from("profiles").upsert({id:e.user.id,nombre:j.nombre.trim(),universidad:j.universidad,carrera:j.carrera});a&&console.error("Profile error:",a),r.push("/dashboard")}catch(e){console.error("General error:",e),y("Error en el servidor")}finally{b(!1)}};return(0,a.jsx)(h.Z,{children:(0,a.jsxs)("div",{className:"min-h-screen flex",children:[(0,a.jsxs)("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-blue-600 to-teal-500 items-center justify-center p-12 relative overflow-hidden",children:[(0,a.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,a.jsx)("div",{className:"absolute top-10 left-10 w-72 h-72 bg-white rounded-full"}),(0,a.jsx)("div",{className:"absolute bottom-10 right-10 w-96 h-96 bg-white rounded-full"})]}),(0,a.jsxs)("div",{className:"relative z-10 text-center",children:[t&&(0,a.jsx)("img",{src:t,alt:"CampusLink",className:"w-full h-96 object-cover rounded-3xl shadow-2xl"}),(0,a.jsx)("h2",{className:"text-white text-3xl font-bold mt-8",children:"CampusLink"}),(0,a.jsx)("p",{className:"text-blue-100 mt-2",children:"\xdanete a la comunidad educativa"})]})]}),(0,a.jsx)("div",{className:"w-full lg:w-1/2 bg-white flex flex-col items-center justify-center p-6 sm:p-12 overflow-y-auto",children:(0,a.jsxs)("div",{className:"w-full max-w-sm",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-slate-900 mb-2",children:"Crear Cuenta"}),(0,a.jsx)("p",{className:"text-slate-600",children:"Empieza tu camino en CampusLink"})]}),(0,a.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[g&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:g}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c._,{htmlFor:"nombre",className:"text-slate-700 font-medium",children:"Nombre Completo"}),(0,a.jsx)(d.I,{id:"nombre",type:"text",value:j.nombre,onChange:e=>N({...j,nombre:e.target.value}),placeholder:"Juan P\xe9rez",className:"mt-2 border-slate-300 focus:border-blue-500 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c._,{htmlFor:"email",className:"text-slate-700 font-medium",children:"Email Universitario"}),(0,a.jsx)(d.I,{id:"email",type:"email",value:j.email,onChange:e=>N({...j,email:e.target.value}),placeholder:"tu@up.edu.pe",className:"mt-2 border-slate-300 focus:border-blue-500 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c._,{htmlFor:"password",className:"text-slate-700 font-medium",children:"Contrase\xf1a"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.I,{id:"password",type:v?"text":"password",value:j.password,onChange:e=>N({...j,password:e.target.value}),placeholder:"M\xednimo 6 caracteres",className:"mt-2 border-slate-300 focus:border-blue-500 focus:ring-blue-500 pr-10",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>w(!v),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-500 hover:text-slate-700",children:v?(0,a.jsx)(m.Z,{className:"h-5 w-5"}):(0,a.jsx)(f.Z,{className:"h-5 w-5"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(c._,{htmlFor:"carrera",className:"text-slate-700 font-medium",children:"Facultad *"}),(0,a.jsxs)(u.Ph,{value:j.carrera,onValueChange:e=>N({...j,carrera:e}),children:[(0,a.jsx)(u.i4,{className:"mt-2 border-slate-300 focus:border-blue-500 focus:ring-blue-500",children:(0,a.jsx)(u.ki,{placeholder:"Selecciona tu facultad"})}),(0,a.jsx)(u.Bw,{children:p.map(e=>(0,a.jsx)(u.Ql,{value:e,children:e},e))})]})]}),(0,a.jsx)(o.z,{type:"submit",disabled:x,className:"w-full bg-slate-900 hover:bg-slate-800 text-white font-semibold py-3 rounded-lg mt-6",children:x?"Creando cuenta...":"Crear Cuenta"})]}),(0,a.jsx)("div",{className:"mt-6 text-center text-sm",children:(0,a.jsxs)("p",{className:"text-slate-600",children:["\xbfYa tienes cuenta?"," ",(0,a.jsx)(n.default,{href:"/auth/login",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"Inicia sesi\xf3n"})]})})]})})]})})}},2775:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var a=r(7437),s=r(9179),l=r(9376),n=r(2265),i=r(9660);function o(e){let{children:t}=e,{user:r,loading:o}=(0,s.a)(),d=(0,l.useRouter)(),{colors:c}=(0,i.F)();return((0,n.useEffect)(()=>{!o&&r&&d.replace("/dashboard")},[o,r,d]),o)?(0,a.jsxs)("div",{className:"fixed inset-0 z-[200] flex flex-col items-center justify-center bg-gradient-to-br from-blue-600 to-teal-500 overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-2xl border-4 animate-pulse",style:{borderColor:"rgba(255, 255, 255, 0.2)"}}),(0,a.jsx)("div",{className:"absolute inset-0 w-20 h-20 rounded-2xl border-t-4 animate-spin",style:{borderTopColor:"white"}})]}),(0,a.jsxs)("div",{className:"mt-8 text-center space-y-2",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white",children:"CampusLink"}),(0,a.jsx)("p",{className:"text-blue-100 text-sm",children:"Cargando..."})]})]}):r?null:(0,a.jsx)(a.Fragment,{children:t})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var a=r(7437),s=r(2265),l=r(6791),n=r(535),i=r(4508);let o=(0,n.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-gray-200 bg-white hover:bg-gray-50 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 hover:text-gray-900",link:"text-blue-600 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3 text-xs",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:d=!1,...c}=e,u=d?l.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(o({variant:s,size:n,className:r})),ref:t,...c})});d.displayName="Button"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return n}});var a=r(7437),s=r(2265),l=r(4508);let n=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm text-gray-950 placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});n.displayName="Input"},6815:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var a=r(7437),s=r(2265),l=r(6394),n=r(535),i=r(4508);let o=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.f,{ref:t,className:(0,i.cn)(o(),r),...s})});d.displayName=l.f.displayName},3647:function(e,t,r){"use strict";r.d(t,{Bw:function(){return p},Ph:function(){return c},Ql:function(){return x},i4:function(){return m},ki:function(){return u}});var a=r(7437),s=r(2265),l=r(7512),n=r(875),i=r(2135),o=r(401),d=r(4508);let c=l.fC;l.ZA;let u=l.B4,m=s.forwardRef((e,t)=>{let{className:r,children:s,...i}=e;return(0,a.jsxs)(l.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...i,children:[s,(0,a.jsx)(l.JO,{asChild:!0,children:(0,a.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.xz.displayName;let f=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.u_,{ref:t,className:(0,d.cn)("flex cursor-pointer items-center justify-center py-1",r),...s,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});f.displayName=l.u_.displayName;let h=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.$G,{ref:t,className:(0,d.cn)("flex cursor-pointer items-center justify-center py-1",r),...s,children:(0,a.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=l.$G.displayName;let p=s.forwardRef((e,t)=>{let{className:r,children:s,position:n="popper",...i}=e;return(0,a.jsx)(l.h_,{children:(0,a.jsxs)(l.VY,{ref:t,className:(0,d.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white text-gray-950 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:n,...i,children:[(0,a.jsx)(f,{}),(0,a.jsx)(l.l_,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,a.jsx)(h,{})]})})});p.displayName=l.VY.displayName;let x=s.forwardRef((e,t)=>{let{className:r,children:s,...n}=e;return(0,a.jsxs)(l.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.wU,{children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(l.eT,{children:s})]})});x.displayName=l.ck.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(l.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-gray-100",r),...s})}).displayName=l.Z0.displayName},9179:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return o},a:function(){return d}});var a=r(7437),s=r(2265),l=r(2141),n=r(9376);let i=(0,s.createContext)(void 0);function o(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[d,c]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),[f,h]=(0,s.useState)(!0),p=(0,n.useRouter)();(0,s.useEffect)(()=>{let e=!0,{data:{subscription:t}}=l.OQ.auth.onAuthStateChange(async(t,r)=>{if(e){if(console.log("[Auth] Event: ".concat(t)),"SIGNED_OUT"===t){console.log("[Auth] Logout detectado. Limpiando estado..."),c(null),o(null),m(null),h(!1);return}(null==r?void 0:r.user)?(console.log("[Auth] Usuario autenticado: ".concat(r.user.email)),c(r),o(r.user),h(!1),("SIGNED_IN"===t||"INITIAL_SESSION"===t)&&x(r.user.id,r.user)):(c(null),o(null),m(null),h(!1))}});return()=>{e=!1,t.unsubscribe()}},[]);let x=async(e,t)=>{try{console.log("[Auth] Cargando perfil en background...");let{data:r,error:a}=await l.OQ.from("profiles").select("*").eq("id",e).single();if(a){console.error("[Auth] Error al cargar perfil:",a.message),"PGRST116"===a.code&&(console.log("[Auth] Perfil no existe. Creando..."),await b(e,t));return}r&&(console.log("[Auth] ✅ Perfil cargado:",r.nombre),m(r))}catch(e){console.error("[Auth] Error inesperado:",e)}},b=async(e,t)=>{try{var r;let a=t.user_metadata,s={id:e,nombre:(null==a?void 0:a.nombre)||(null===(r=t.email)||void 0===r?void 0:r.split("@")[0])||"Usuario",universidad:(null==a?void 0:a.universidad)||"Universidad Privada",carrera:(null==a?void 0:a.carrera)||"Estudiante",puntos:0},{data:n,error:i}=await l.OQ.from("profiles").insert([s]).select().single();if(i){console.error("[Auth] Error creando perfil:",i);return}console.log("[Auth] ✅ Perfil creado:",n.nombre),m(n)}catch(e){console.error("[Auth] Error al crear perfil:",e)}},g=async()=>{r&&await x(r.id,r)},y=async e=>{m(e)},v=async()=>{try{console.log("[Auth] Cerrando sesi\xf3n..."),await l.OQ.auth.signOut(),localStorage.clear(),sessionStorage.clear(),p.push("/auth/login")}catch(e){console.error("[Auth] Error en signOut:",e)}};return(0,a.jsx)(i.Provider,{value:{user:r,session:d,profile:u,loading:f,signOut:v,refreshProfile:g,updateProfile:y},children:t})}function d(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2141:function(e,t,r){"use strict";r.d(t,{OQ:function(){return a},q4:function(){return s}});let a=(0,r(338).createBrowserClient)("https://mevfhlhwrrkbhppgeyaj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1ldmZobGh3cnJrYmhwcGdleWFqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NDgyMDIsImV4cCI6MjA3NzUyNDIwMn0.E_Rhnhh8dbRiBLTg52HpDfJSqv2Q_hE-mSjHlkLF2IE");async function s(e){return await e()}},9660:function(e,t,r){"use strict";r.d(t,{F:function(){return o},ThemeProvider:function(){return d}});var a=r(7437),s=r(2265),l=r(2141);let n={"Facultad de Ciencias Empresariales":{primary:"#0066FF",secondary:"#E6F0FF",dark:"#0052CC",light:"#F0F7FF"},"Facultad de Derecho":{primary:"#FF0000",secondary:"#FFE6E6",dark:"#CC0000",light:"#FFF0F0"},"Facultad de Econom\xeda y Finanzas":{primary:"#00CC00",secondary:"#E6FFE6",dark:"#009900",light:"#F0FFF0"},"Facultad de Ingenier\xeda":{primary:"#FFCC00",secondary:"#FFFAE6",dark:"#CC9900",light:"#FFFBF0"}},i=(0,s.createContext)({faculty:null,colors:null,setFaculty:()=>{},loading:!0,themeMode:"glass",setThemeMode:()=>{}}),o=()=>(0,s.useContext)(i);function d(e){let{children:t}=e,[r,o]=(0,s.useState)(null),[d,c]=(0,s.useState)(!0),[u,m]=(0,s.useState)("glass");(0,s.useEffect)(()=>{let e=localStorage.getItem("themeMode");e&&["light","dark","glass"].includes(e)?(m(e),document.documentElement.setAttribute("data-theme",e)):(m("glass"),document.documentElement.setAttribute("data-theme","glass"))},[]),(0,s.useEffect)(()=>{let e=async()=>{try{let{data:{user:e}}=await l.OQ.auth.getUser();if(e){let{data:t}=await l.OQ.from("profiles").select("carrera").eq("id",e.id).single();(null==t?void 0:t.carrera)?o(t.carrera):o(null)}else o(null)}catch(e){console.error("Error loading user faculty:",e),o(null)}finally{c(!1)}};e();let{data:{subscription:t}}=l.OQ.auth.onAuthStateChange(async(t,a)=>{("SIGNED_IN"===t||"SIGNED_OUT"===t||"USER_UPDATED"===t)&&(r||c(!0),await e())});return()=>{null==t||t.unsubscribe()}},[]),(0,s.useEffect)(()=>{if(r&&r in n){let e=n[r];document.documentElement.style.setProperty("--faculty-primary",e.primary),document.documentElement.style.setProperty("--faculty-secondary",e.secondary),document.documentElement.style.setProperty("--faculty-dark",e.dark),document.documentElement.style.setProperty("--faculty-light",e.light)}},[r]);let f=r&&r in n?n[r]:n["Facultad de Ciencias Empresariales"];return(0,a.jsx)(i.Provider,{value:{faculty:r,colors:f,setFaculty:e=>{o(e)},loading:d,themeMode:u,setThemeMode:e=>{m(e),localStorage.setItem("themeMode",e),document.documentElement.setAttribute("data-theme",e)}},children:t})}},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return l}});var a=r(1994),s=r(3335);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},7769:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},2208:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9763).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},function(e){e.O(0,[338,137,451,183,108,971,117,744],function(){return e(e.s=2864)}),_N_E=e.O()}]);